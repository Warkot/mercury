<!DOCTYPE html>
<html lang="{{wikiVariables.language.content}}" dir="{{wikiVariables.language.contentDir}}">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<title>{{htmlTitle}}</title>
		<meta name="keywords" content="{{#if wikiVariables.siteMessage}}{{wikiVariables.siteMessage}},{{/if}}{{wikiVariables.siteName}},{{wikiVariables.dbName}},{{displayTitle}}">
		<meta name="description" content="{{article.data.details.description}}">
		<meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1, maximum-scale=1, minimal-ui">

		{{#if themeColor}}
			<meta name="theme-color" content="{{themeColor}}">
		{{/if}}
		{{#if wikiVariables.specialRobotPolicy}}
			<meta name="robots" content="{{wikiVariables.specialRobotPolicy}}">
		{{/if}}
		{{#if asyncArticle}}
			<meta name="fragment" content="!">
		{{/if}}

		{{#if isRtl}}
			<!-- build:css /front/styles/main/app.rtl.css -->
			<link rel="stylesheet" href="/front/styles/main/app.rtl.css">
			<!-- endbuild -->
		{{else}}
			<!-- build:css /front/styles/main/app.css -->
			<link rel="stylesheet" href="/front/styles/main/app.css">
			<!-- endbuild -->
		{{/if}}

		{{> open-graph-tags}}

		<link rel="canonical" href="{{canonicalUrl}}">

		<style><!-- @include ../../../www/front/styles/main/baseline.css --></style>

		{{> nirvana }}
		<script>
			<!-- @include ../../../www/front/scripts/baseline.js -->
			state.prop('apiBase', '{{{server.apiBase}}}' || '/api/mercury');
			state.prop('environment', '{{{server.environment}}}');
			state.prop('queryParams', {{{json queryParams}}});
			state.prop('tracking', {{{json tracking}}});
			state.prop('translations', {{{json (translations wikiVariables.language.content ns='main')}}});
			state.prop('weppyConfig', {{{json localSettings.weppy}}});
			state.prop('wikiaLanguage', '{{{wikiVariables.language.content}}}');
			state.prop('userId', {{{userId}}});
			state.prop('cookieDomain', {{{json localSettings.authCookieDomain}}});
			state.prop('servicesDomain', {{{json localSettings.servicesDomain}}});
			state.prop('discussionBaseRoute', {{{json localSettings.discuss.baseAPIPath}}});
			{{#if discussionsSplashPageConfig}}
				prop('discussionsSplashPageConfig', {{{json discussionsSplashPageConfig}}});
			{{/if}}
			{{!-- TODO: The ad code actually depends on this being at this exact namespace :/ Must fix, is very brittle currently --}}
			state.provide('ads.slots', []);
			state.provide('wiki', {{{json wikiVariables}}});

			{{#if server.mediawikiDomain}}
				state.prop('mediawikiDomain', '{{server.mediawikiDomain}}');
				state.prop('adsUrl', '//{{server.mediawikiDomain}}/__am/{{wikiVariables.cacheBuster}}/groups/-/mercury_ads_js');
			{{/if}}
			{{#if asyncArticle}}
				state.prop('asyncArticle', {{asyncArticle}});
			{{/if}}
			{{#if article}}
				state.prop('articleContentPreloadedInDOM', true, true);
				state.provide('article', {{{json article}}});
			{{/if}}
			{{#if mainPageData}}
				state.prop('mainPageData', {{{json mainPageData}}});
			{{/if}}
			{{#if exception}}
				state.provide('exception', {{{json exception}}});
			{{/if}}
			{{#if server.optimizelyScript}}
				state.prop('optimizelyScript', '{{{server.optimizelyScript}}}');
			{{/if}}

		</script>

		<!-- @ifdef browserSync -->
		<script src="/front/scripts/dev.js"></script>
		<!-- @endif -->

		{{> tracking}}
	</head>
	<body>
		{{> qualaroo}}
		<!-- @include ../../../www/front/svg/common.svg -->
		<!-- @include ../../../www/front/svg/main.svg -->

		{{!--
		Ember must render out to a specific div above the scripts, otherwise
		Google PageSpeed will mistakenly believe that we have scripts loading and blocking content
		DO NOT REMOVE THE FOLLOWING LINE:
		--}}
		<div id="ember-container">
			<div id="preload">
				<nav class="site-head">
					<div class="site-logo">
						<svg role="img" class="icon wikia-logo">
							<use xlink:href="#wikia-logo"></use>
						</svg>
					</div>
				</nav>
				<div class="page-wrapper" lang="{{wikiVariables.language.content}}" dir="{{wikiVariables.language.contentDir}}">
					{{{content}}}
				</div>
			</div>
		</div>

		<script>
			(function () {
				document.addEventListener("DOMContentLoaded", function() {
					loadScript.loadScript('/front/vendor/main.js', function () {
						loadScript.loadScript('/front/scripts/combined.js');
					});
				});
			}());
		</script>
		<script src="//{{server.mediawikiDomain}}/__load/-/only=scripts/wikia.ext.instantGlobals,instantGlobalsOverride,abtesting" async></script>
		{{> tracking-pixels}}
	</body>
</html>
